# âœ… PostgreSQL æ•°æ®åº“è¿ç§»å®Œæˆ

## ğŸ‰ å·²å®Œæˆçš„å·¥ä½œ

### 1. æ•°æ®åº“é…ç½®
- âœ… é…ç½®PostgreSQLè¿æ¥
- âœ… åˆ›å»ºæ•°æ®åº“æ¨¡å‹ï¼ˆ8ä¸ªè¡¨ï¼‰
- âœ… æ•°æ®åº“é€‚é…å±‚ï¼ˆdb_adapter.pyï¼‰
- âœ… è‡ªåŠ¨åˆå§‹åŒ–è„šæœ¬

### 2. æ ¸å¿ƒåŠŸèƒ½è¿ç§»
- âœ… ç”¨æˆ·æ³¨å†Œ/ç™»å½•
- âœ… TokenéªŒè¯å’Œç®¡ç†
- âœ… ç”¨æˆ·èµ„æ–™ç®¡ç†
- âœ… å¯†ç ä¿®æ”¹
- âœ… å¥èº«è®¡åˆ’ç®¡ç†

### 3. æ–‡æ¡£
- âœ… `setup_postgresql.md` - è¯¦ç»†è®¾ç½®æŒ‡å—
- âœ… `QUICK_START.md` - 5åˆ†é’Ÿå¿«é€Ÿå¼€å§‹
- âœ… `DATABASE_MIGRATION.md` - è¿ç§»è¯´æ˜

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ­¥éª¤1: å®‰è£…PostgreSQL

**Windows:**
ä¸‹è½½å®‰è£…: https://www.postgresql.org/download/windows/

**macOS:**
```bash
brew install postgresql
brew services start postgresql
```

**Linux:**
```bash
sudo apt-get install postgresql postgresql-contrib
sudo systemctl start postgresql
```

### æ­¥éª¤2: åˆ›å»ºæ•°æ®åº“

```bash
createdb -U postgres fitnessai
```

### æ­¥éª¤3: é…ç½®ç¯å¢ƒå˜é‡ï¼ˆå¯é€‰ï¼‰

åœ¨ `backend/.env` æ–‡ä»¶ä¸­ï¼š

```env
DATABASE_URL=postgresql://postgres:postgres@localhost:5432/fitnessai
```

**æ³¨æ„**: å¦‚æœä¸åˆ›å»º.envæ–‡ä»¶ï¼Œä¼šä½¿ç”¨é»˜è®¤é…ç½®

### æ­¥éª¤4: å®‰è£…ä¾èµ–

```bash
cd backend
pip install -r requirements.txt
```

### æ­¥éª¤5: åˆå§‹åŒ–æ•°æ®åº“

```bash
python init_database.py
```

è¿™ä¸ªè„šæœ¬ä¼šï¼š
- åˆ›å»ºæ‰€æœ‰æ•°æ®åº“è¡¨
- è‡ªåŠ¨è¿ç§»ç°æœ‰JSONæ•°æ®ï¼ˆå¦‚æœæœ‰ï¼‰
- éªŒè¯è¿æ¥

### æ­¥éª¤6: å¯åŠ¨åº”ç”¨

```bash
python app.py
```

## ğŸ“Š æ•°æ®åº“ç»“æ„

### è¡¨åˆ—è¡¨
1. **users** - ç”¨æˆ·åŸºæœ¬ä¿¡æ¯
2. **user_profiles** - ç”¨æˆ·è¯¦ç»†èµ„æ–™
3. **tokens** - è®¤è¯Token
4. **plans** - å¥èº«è®¡åˆ’
5. **sessions** - è¿åŠ¨ä¼šè¯
6. **user_achievements** - ç”¨æˆ·æˆå°±
7. **checkins** - æ‰“å¡è®°å½•
8. **challenge_completions** - æŒ‘æˆ˜å®Œæˆè®°å½•

## ğŸ”„ æ•°æ®è¿ç§»

### è‡ªåŠ¨è¿ç§»
`init_database.py` ä¼šè‡ªåŠ¨æ£€æµ‹å¹¶è¿ç§»ä»¥ä¸‹JSONæ–‡ä»¶ï¼š
- `users.json` â†’ `users` è¡¨
- `tokens.json` â†’ `tokens` è¡¨
- `plans.json` â†’ `plans` è¡¨
- `sessions.json` â†’ `sessions` è¡¨
- `achievements.json` â†’ `user_achievements` è¡¨
- `checkins.json` â†’ `checkins` è¡¨
- `challenges.json` â†’ `challenge_completions` è¡¨

### è¿ç§»å
- JSONæ–‡ä»¶ä¼šä¿ç•™ä½œä¸ºå¤‡ä»½
- å¯ä»¥å®‰å…¨åˆ é™¤ï¼ˆå»ºè®®å…ˆç¡®è®¤æ•°æ®æ­£ç¡®ï¼‰

## ğŸŒ éƒ¨ç½²åˆ°æœåŠ¡å™¨

### 1. åœ¨æœåŠ¡å™¨ä¸Šå®‰è£…PostgreSQL

```bash
sudo apt-get update
sudo apt-get install postgresql postgresql-contrib
```

### 2. åˆ›å»ºæ•°æ®åº“

```bash
sudo -u postgres createdb fitnessai
```

### 3. é…ç½®è¿æ¥

åœ¨æœåŠ¡å™¨ä¸Šåˆ›å»º `.env` æ–‡ä»¶ï¼š

```env
DATABASE_URL=postgresql://username:password@localhost:5432/fitnessai
```

### 4. è¿ç§»æ•°æ®

ä»æœ¬åœ°å¯¼å‡ºï¼š
```bash
pg_dump -U postgres fitnessai > backup.sql
```

åœ¨æœåŠ¡å™¨ä¸Šå¯¼å…¥ï¼š
```bash
psql -U username -d fitnessai < backup.sql
```

### 5. åˆå§‹åŒ–

```bash
python init_database.py
python app.py
```

## ğŸ“ æ•°æ®åº“ç®¡ç†

### è¿æ¥æ•°æ®åº“

```bash
psql -U postgres -d fitnessai
```

### å¸¸ç”¨å‘½ä»¤

```sql
-- æŸ¥çœ‹æ‰€æœ‰è¡¨
\dt

-- æŸ¥çœ‹è¡¨ç»“æ„
\d users

-- æŸ¥çœ‹æ•°æ®
SELECT * FROM users LIMIT 10;

-- é€€å‡º
\q
```

### å¤‡ä»½

```bash
pg_dump -U postgres fitnessai > backup.sql
```

### æ¢å¤

```bash
psql -U postgres fitnessai < backup.sql
```

## âœ… éªŒè¯å®‰è£…

è¿è¡Œæµ‹è¯•ï¼š

```bash
python -c "from app import app; from database import db; app.app_context().push(); db.create_all(); print('âœ… æ•°æ®åº“è¿æ¥æˆåŠŸï¼')"
```

## ğŸ¯ ä¼˜åŠ¿

ä½¿ç”¨PostgreSQLåï¼š
- âœ… **æ€§èƒ½æå‡**: æ¯”JSONæ–‡ä»¶å¿«å¾—å¤š
- âœ… **æ•°æ®å®Œæ•´æ€§**: å¤–é”®çº¦æŸã€äº‹åŠ¡æ”¯æŒ
- âœ… **å¹¶å‘æ”¯æŒ**: å¤šç”¨æˆ·åŒæ—¶è®¿é—®
- âœ… **æ˜“äºæ‰©å±•**: æ”¯æŒå¤æ‚æŸ¥è¯¢å’Œç´¢å¼•
- âœ… **æ˜“äºå¤‡ä»½**: pg_dumpå·¥å…·
- âœ… **ç”Ÿäº§å°±ç»ª**: é€‚åˆæœåŠ¡å™¨éƒ¨ç½²

## ğŸ“– æ›´å¤šæ–‡æ¡£

- `backend/setup_postgresql.md` - è¯¦ç»†è®¾ç½®æŒ‡å—
- `backend/QUICK_START.md` - å¿«é€Ÿå¼€å§‹æŒ‡å—
- `backend/DATABASE_MIGRATION.md` - è¿ç§»è¯´æ˜

## ğŸ‰ å®Œæˆï¼

ç°åœ¨ä½ çš„åº”ç”¨å·²ç»ä½¿ç”¨PostgreSQLæ•°æ®åº“äº†ï¼

æ‰€æœ‰æ–°æ•°æ®éƒ½ä¼šå­˜å‚¨åœ¨PostgreSQLä¸­ï¼Œæœªæ¥è¿ç§»åˆ°æœåŠ¡å™¨æ—¶åªéœ€è¦ä¿®æ”¹è¿æ¥å­—ç¬¦ä¸²å³å¯ã€‚

